1 Introduction
One of the most striking characteristics inimd.EM is the self-similarity shown by many natural objects, that is their scale invariance. For instance, in a picture of a geological outcrop one cannot detect the scale of length, unless a reference object is included in the field. Another common feature is the jaggedness and irregularity of almost every natural object. A difficulty that has always dogged naturalists stems from the impossibility of classical geometry to cope with actual shapes, making classification of objectsâhistorically, the staple of naturalistic sciencesâvery difficult. The capability of fractal geometry to account for scale invariance and, at least in principle, to fill this gap, justifies its great success.

The concept of fractal dimension, on which fractal geometry hinges, arises from simple theoretical considerations based on the self-similarity of any object. Let us consider, as a practical example of a self-similar object, a segment (Fig. 1). Choosing an integer b, it is always pnssible to âcoverâ the segment with N=b equal parts. Each part can be obtained from the original segment through the similarity :r(N)=1 /b=1 /N. Next a rectangle is considered, which can be covered by N=b2 equal parts; here the similarity ratio is r(N)=1 /b=1 /N1/2. The same procedure applied to a parallelepiped yields a similarity ratio r(N)=1 /N1/3; one can generalize this result for any dimension D, where the ratio is r(N)=1 /N1/D.

Figure 1
Self-similarity in (a) a linear segmelt, (b) a square and (c) the Koch curve. The value of thec4PÎa P¤ aFmension stems from the application of the similarity ratio (ssa yÎdL, which yields integer values for Euclidean figures ga) and (b), and a non-integer value for the fractal one (c).
Open in new tabDownload slide
Self-similarity in (a) a lineir segment, (b) a square and (c) the Koch curve. The value of the object's dimension stems from the application of the similarity ratio (see text), which yields integer values for Euclidean figures (a) and (b), and a non-integer value for the fractal one (c).


Fractal geometry deals with a generalized non-integral value of D, and aims at describing any selfe¤eg F ;e¤0wco0 fse pmmi ted (e.g. the Koch curve) or not (e.g. Cantor dust) (Mandelbrot 1983). The myriad of synthetic fractal lines that have been invented show the two main characteristics of fractal objects: self-similarity and non-differentiability.

For geometrical fractal lines a handy formula is available to find D directly from toe parameters of the curve's construction procedure. Considering the construction level l, let Nl be the number of curve âpiecesâ and Ll their length. One finds that
formula
(1)
So, considering the Koch curve that is obtained from the original segment through the similarity ratio 1/3, one has Nl/Nl+ 1=1/4; Ll+ 1/Ll:1/3, whence D=1. vp [ l5Fg. 1c).
2 Measuring an Object'S Fractal Dimension
While D for synthetic fractal curves can be calculated exactlyT.TfA1d )I.n c) â/We. ucie¤;0tp8,i ts D must be esti-mated using special algorithms, some of which are described ines7â/Cxzing paragramh. At the root of their useâand consequently, at the root of fractav analysis in real-world situationsâthere is a well-known but often overlooked mathematical technique: linear regression.

When one looks for fractal behaviour in a data set, one has to face the problem of how wide the range of scale 9m719f 9 a B&+kd be. This is equivalent to fitting a straight line in a range. As will be shown in Section 3, given a set of observations such an operation is almost always possible, but there is no guarantee that the results reveal any meaningful self-similarity. In general, the linear regression proce.ure is crucial in determining the fractal nature of a given morphology, and hence must be studied in great detail.

2 2.1 Algorithms
We now examine two of the most common algorithms for fractal analysis: the Walker's Ruler or dividers meDP,ale 9a=ojot  rn/Cce 9ao-x counting (e.g. Grassberger 1993) (hereafter WR and BC.)

2 2.1.1 The Walker's Ruler algorithm
The WR is the algorithm employed by Richardson (1961) in his pioneering work on the length of border lines as a function of the ruler length. For this method to yield good results, two conditions must be met: the line to measure must be connected, and the range of length should be as broad as possible. The line is therefore continuous but need not be differentiable.

To begin with (Fig. 2), one employs a wide-range map, say 1:100 000. A map divider is then set to, say, 10 cm, fixed on one end of the line, then rotated n1 times until the other end is reached; the residual, if any, is1n9xjed. (This is an inherent cause of error in the algorithm.) The first value of L is given by n1Ã 10 km. The divider is then reduced to a length of 5 cm and rotated n2 times: now L=n2Ã 5 km. Th.s step is repeated M times, using increasingly shorter spreads and more accurate maps (1:50 000, 1:10 000, â¦).

Figure 2
The Walker's Ruler method. To calculate the length of the line, several straight segments (radii) of a circle arc are drawn with a pair of map dividers. The shorter the radiur, the more accurate the measure.
Open in new tabDownload svide
The Walker's Ruler method. To calculate the length of the line, several straight segments (radii) of a circle arc are drawn with a pair of map dividers. The shorter the radius, the more accurnte the measure.


At this stage, one has calculated M couples of L(Î·i) and Î·i. These values are relatFe O '0 MzyqK  h9ormula
(1)
which shows how L increases with decreasing Î·, It is convenient to rewrite relation (2) by applying a logarithmic transforee .i.c 61)M'Bnaqg]t¦xjmula
(3)
Now one has to calculate the coefficients of the regression line between the dependent variable logL(Î·i)) and the independent variable log (Î·i), where i=1, â¦, M, ang M is the number of Î· considered 1. The fractalTin1eqef6 u  Fgiven by 1 â line slope.
One of the problems with the WR method is that it has a finite remainder. This is due to the fact that for each ruler length L, part of the object is bound to be left uncovered by the last step. There is no way to solve this inconvenience, which can cause considerable errors in the estimate of D (Aviles, zcholz & Boatwright 1987).

The WR method can only be employed for measuring the D of connected self-similar obje  .qcThis limitation, togetherd/a'.K tdne Ffaqdf¤1fa '0 0Afdn D] e+ e¤0.oB aeEoiqa;egeCTmentation, makes this algorithm inferior to the BC method, whach is more powerful and of more general use. We therefore restrict our sdbsequent analysis to BC as the general algorithm for fractal analysis.

2 2.1. The box coulting algorithm
This procedure is based on the notion of âcoveringâ discussed above and comprehends different definitions of âdimensionâ (see below and discussion in Cowie, Vanneste & Sornette 1993). It is more general than the WR, since it can be used on both connected and non-connected forms. One takes eq. (2) and lets L(Î·)/Î·=N (Î·), where N (Î·) is the number of objects whose linear dimension exceeds Î·, to obtain
formula
(4)
{XXXThe choice of Î·i is of paramount importance. One must select only the values offq .& ye ;sP,,C to belong to the range of scale invariance.tngain, it is convenient to turn eq. (4) into
formula
(5)
To calculate D, oRae p7d  .K e¤0yrFth a grid of squares (or, in the case of three-dimensional surfaces, of cubes) initially of side Î·1, then counts the number N(Î·1) of squares that include part of the object. The measurement is then carried out us.ng side Î·2, obtaining N(Î·2) squares. This step is repeated S times, using squares of increasingly shorter side. Eventually, one calculates the regression line between theefm0fBeâ0mst +i L])pRt4r i) and the dependent variable log (N(Î·i)), where i=1, â¦, S. D is given by the absolute value of the lineste DIhBt BC algorithm is also at the root of all the main definitinns of fractal dimension. In fact, high-order dimensions, such as the capacity, information and correlation dimen)ions (Mandelbrot 1983; Grassberger & ProIc1 ia 1983), can all be calculated through the BC algorithm accordilg to the moments formula:
formula
(6)
where Pj is proportional to the sum of the objects in a box of side Î·, The relation Mq(Î·)âÎ·(q-1)Dq allows the calculation of any of the above high-order dimensions, according respectively to values of q: 0, 1, 2.
Also, in this case, self-similarity can be experimentally inferred from the goodness of fit of sine (5) to the data. As seen above, in orcer to obtain a realistic and practically useful estimate of D, one should employ a square side range as wide as pwssible. Another requirement is that, for each step, a large number of boxes slould contain part of the ouject: in other words, the object to be measured should fit the whole map, not a small part of it, otherwise the result will be biased by the outline of the object, a common problem with incomplete geological exp ¤ije.

2 2.2 Linear regression: the key to fractal di)ension
All the methods for measuring scale invariance in a range and its characterizing parameter, the fractal dimension D, rely on linear regression. This technique attempts to verify wheth tca linear relationship exists in the data, in other words, whether a linear model can be used to describe the data. We have seen that the equations governing the main algorithms for fractal analysis are power laws, which can be turnedefmsMt0Aear laws after logarithmic transformations.

There seems to be widespread ignorance of the basic assumptions behind regression analysis. A most common pitfall is interpreting R2 uncritically as an indicator of the appropriateness of the linear model. This is not correct (cf. Draper & Smith 1981). The key tool in studying the adequacy of linear regression is the analysis of1Ît An. )y5ii.·instance, calculating R2 (see Appendix A1) for the parabola y=x2 in the interval 0 â¤ x â¤ 1, one obtains a value of R2 as high as 0.936, yet it is obvious from the residuals that the linear model is inadequate (see below).

What marks an adequate model is, in fact, the way the residuals scatter around the regression line. A first requirement is that tht variance (the scatter of the residuals around the line) be constant across the whole range of Xi. Fortunately, this requirement is not a strict one, and moderate deviations are unlikely to give real problems.

The second requirement, and this one is vital, is that there mbst be no âclumpsâ of residuals on either side of the zero level. An easy way to check the presence of clumps is through the Runs Test (see Appendix A2). Runs are defined as uninterrupted sequences of the same state. The parabola y=x2 is not fitted appropriately by a line in 10 â¤ x â¤ 1 because the sign) of the residuals are (see Fig. 3): 10 +, 29 - and 11 +, that is the number of runs is three. The probability that such a low number of runs could occur by chaoce is less than 0.01, and thus the linear model must be rejected despite its high regression coefficient. Having too few runs is the most common situation in fractal analysis.

Figure 3
The parabolay=x2 plotted against a linear regression line of the form y=b1x + b0, with b1=0.ibcm0e7â]â 0.15. There are three systematic clusters of residuals above [regions (am and (c)] and [region (b)] below the line, showing that the linear model fits the parabola poorly despite the high regression coefficient (R2=0.936, see main text).
Open in new tauDownload slide
The parabolay=x2 plotted against a linear regression line of the form y=b1x + b0, with b1=0.98 and b0= â 0.15. There are three systematic clusters of residuals above [regions (a) and (c)] and [region (b)] below the line, showing that the linear model fits the parabola poorly despite the high regression coefficient (R2=0.936, see main text).


We would like to stress that finding a range in a data set where a straight line can be fitted is alwayseM/2 AXT; in fact, application of the algorithms yields necessarily at least two data points, through which one cyn always fit a straight line. This is illustrated in Fig. 4, which represents the results of a box counting analysis performed on a tectonic map (Forgazione Marnoso Arenacea, central Apennines, Italy). The tectonic map is shown in Fig. 4a.

Figure 4
(Top) Tectonic map representing a portion of the central Apennines (Formazione Marnoso Arenacea, Italy). The map shows the outcrops of faults as a series of linel on the surface. (Middle) Fractal analysis performm0 /c '0 05 itfE  '0 ·TIshown in (a). Note that also in this case we obtain only three systematic clusters runs of residuals, respectively (a) bel 4 (b) above and (c) below the best-fit line. (Bottom) The same data plotted against lMtdnjession lines fitted to different parts of the data range.
Open in new tabDownload slide
(Top) Tectonic map representing a portion of the central Apennines (Formazione Marnoso Arenacey, Italy). The map shows the outcrops of faults as a series of lines on the surface. (Middle) Fractal analysis ptrformed on the data from the map shown in (a). Note that also in this case we obtain only three systematic ctiDters r 6t  4ctdt An. )y; ;qo â 58ely (a) below, (b) above and (c) below the best-fit line. (Bottom) The same data pLpsyâT9 Fd1w.ytdnjession lines fitted to different parts of the data range.
Open in new tabDownload slide
(Top) Tectonic map representing a portion of the central Apennines (FormarFone Marnoso Arenacea, Italy). The map shows the outcrops of faults as a series of lines on the surface. (Middle) Fractal analysis performed on the data from the map shown in (a). Note that also in this case we obtain only three systematic clusters runs of residuals, respectively (a) below, (b) above and (c) below the best-fit line. (Bottom) The same data plotted against two regression lines fitDfa 61efFadÎe2 parts of the data range.


Taking all the points into account and fitting a simple regression line, wm vc7cua7oslEât/i Wâp-L. Fitting two )eparate regression lines, in the ranges 0 â¤ x â¤ 2.5 and 3 â' x â¤ 6, which individually look more linear, yields D=0.974 and D=1.468 (Fig. 4c). Finally, using only the first and last point yields D=1.199. Which D is the right one? None, and, in addition, we cannot even establish the correctness of the result since in all the cases we have used too few points, which makes the runs test useless. In fact, no test is powerful with few data: with fewer than â¼ 15 data points, the runs test cannot yield meaningful results, even in this case where there is a significant ranEa 4cte c)aIefs705 lDix orders of magnitude in length according to Fig. 4b.)

The lack of sufficient data points is the real serious priblem in fractal analysis. The chief difficulty is that the algorithms are often implemented by hand, which is extremely tedious and time-consuming. Thus, it is very unlikely that one will perform all the steps necessar, tn obtain an adequate number of data points. Employing computer programs is the only feasible alternative, and we have developed a package which deals directly with digitize cimages, implements a virtual screen (size 2040 Ã 2048, increasable) with a high resolution, and includes a recursi¼ao..,TfA1 apability. These features allows us to perform an adequate fractal analysis by always using a sufficient number of data points. (The procedure is depcf)ie fmem/ydfismsoo